$(function(){function m(a){var b=a.split("/")[0];$(".page").removeClass("visible");var f={"":function(){c={};h.prop("checked",!1);k(g)},"#feature":function(){var b=a.split("#feature/")[1].trim();n(b,g)},"#filter":function(){a=a.split("#filter/")[1].trim();try{c=JSON.parse(a)}catch(b){window.location.hash="#";return}p(c,g)}};if(f[b])f[b]();else $(".error").addClass("visible")}function q(a){var b=$(".features-list"),f=$("#features-template").html(),f=Handlebars.compile(f);b.append(f(a));b.find("li").on("click",
function(a){a.preventDefault();a=$(this).data("index");window.location.hash="feature/"+a})}function k(a){var b=$(".features-list > li");b.addClass("hidden");b.each(function(){var b=$(this);a.forEach(function(a){b.data("index")==a.id&&b.removeClass("hidden")})})}function n(a,b){var c=$(".single-feature"),e=$(".preview-large");b.length&&b.forEach(function(b){b.id==a&&(e.find("h3").text(b.header),e.find("p").text(b.fulltext))});c.addClass("visible")}function p(a,b){var c=[],e=!1;h.prop("checked",!1);
["manufacturer","storage","os","camera"].forEach(function(d){a[d]&&a[d].length&&(e&&(b=c,c=[]),a[d].forEach(function(a){b.forEach(function(b){"number"==typeof b.specs[d]&&b.specs[d]==a&&(c.push(b),e=!0);"string"==typeof b.specs[d]&&-1!=b.specs[d].toLowerCase().indexOf(a)&&(c.push(b),e=!0)});d&&a&&$("input[name="+d+"][value="+a+"]").prop("checked",!0)}))});k(c)}var g=[],c={},h=$(".all-features input[type=checkbox]");h.click(function(){var a=$(this),b=a.attr("name");a.is(":checked")&&(c[b]&&c[b].length||
(c[b]=[]),c[b].push(a.val()),window.location.hash="#");a.is(":checked")||(c[b]&&c[b].length&&-1!=c[b].indexOf(a.val())&&(a=c[b].indexOf(a.val()),c[b].splice(a,1),c[b].length||delete c[b]),window.location.hash="#")});$(".filters button").click(function(a){a.preventDefault();window.location.hash="#"});var l=$(".single-feature");l.on("click",function(a){a.preventDefault();l.hasClass("visible")&&(a=$(a.target),a.hasClass("close")||a.hasClass("overlay"))&&(window.location.hash="#")});$.getJSON("features.json",
function(a){g=a;q(g);$(window).trigger("hashchange")});$(window).on("hashchange",function(){m(decodeURI(window.location.hash))})});